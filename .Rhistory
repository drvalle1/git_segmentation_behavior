#number of iterations
ngibbs=20000
#matrix to store results
store.param=matrix(NA,ngibbs,2)
for (i in 1:ngibbs){
print(i)
vals=samp.move(breakpt=breakpt,max.time=max.time,dat=dat,
alpha=alpha,max.Vp=max.Vp,max.Vt=max.Vt)
breakpt=vals[[1]]
#store results
store.param[i,]=c(length(vals[[1]]), vals[[2]])
}
list(breakpt=breakpt,store.param=store.param)
}
source('gibbs functions2.R')
source('helper functions.R')
source('gibbs sampler2.R')
behav.list2<- behav.prep_veloc(dat=dat, tstep = 3600)  #add move params and filter by 3600 s interval
dat27.res2<- behav.gibbs.sampler_veloc(behav.list2$`27`,50000)
source('gibbs sampler2.R')
dat27.res2<- behav.gibbs.sampler_veloc(behav.list2$`27`,50000)
source('gibbs sampler2.R')
length(dat27.res$breakpt)
par(mfrow=c(3,1))
plot(behav.list2$`27`$SL, xlab = "", ylab = "SL"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=2)")
plot(behav.list2$`27`$TA, xlab = "", ylab = "TA"); abline(v=dat27.res2$breakpt,col='red')
plot(behav.list2$`27`$TAA, xlab = "Time", ylab = "TAA"); abline(v=dat27.res2$breakpt,col='red')
plot(behav.list2$`27`$SL, xlab = "", ylab = "SL")
behav.list2$`27`$SL
plot(behav.list$`27`$SL, xlab = "", ylab = "SL")
behav.list2$`27`$SL
plot(behav.list2$`27`$Vp, xlab = "", ylab = "SL")
par(mfrow=c(3,1))
plot(behav.list2$`27`$Vp, xlab = "", ylab = "SL"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=2)")
plot(behav.list2$`27`$Vt, xlab = "", ylab = "TA"); abline(v=dat27.res2$breakpt,col='red')
length(dat27.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`27`$Vp, xlab = "", ylab = "SL"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=3)")
plot(behav.list2$`27`$Vt, xlab = "", ylab = "TA"); abline(v=dat27.res2$breakpt,col='red')
behav.heat<- behav.seg.image(behav.list2$`27`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
source('helper functions.R')
behav.heat<- behav.seg.image_veloc(behav.list2$`27`)
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
par(mfrow=c(1,1))
plot(dat27.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 27")
plot(dat27.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 27")
write.csv(dat27.res2$breakpt, "ID27 Breakpoints (Behavior) Vp_Vt.csv", row.names = F)
dat27.res2<- behav.gibbs.sampler_veloc(behav.list2$`27`,50000)
length(dat27.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`27`$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=3)")
plot(behav.list2$`27`$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt,col='red')
behav.heat<- behav.seg.image_veloc(behav.list2$`27`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
par(mfrow=c(1,1))
plot(dat27.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 27")
plot(dat27.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 27")
write.csv(dat27.res2$breakpt, "ID27 Breakpoints (Behavior) Vp_Vt.csv", row.names = F)
png("ID 27 behav seg plot Vp_Vt.png", width = 8, height = 6, units = "in", res = 400)
par(mfrow=c(2,1))
plot(behav.list2$`27`$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=3)")
plot(behav.list2$`27`$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt,col='red')
dev.off()
png("ID 27 behav seg image Vp_Vt.png", width = 8, height = 6, units = "in", res = 400)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
dev.off()
dat19.res2<- behav.gibbs.sampler_veloc(behav.list2$`19`,50000)
length(dat19.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`19`$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt,col='red'); title(main="ID 19 (n=3)")
plot(behav.list2$`19`$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt,col='red')
behav.heat<- behav.seg.image_veloc(behav.list2$`19`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue'); title(main="ID 19 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue')
par(mfrow=c(1,1))
plot(dat19.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 19")
plot(dat19.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 19")
png("ID 19 behav seg plot Vp_Vt.png", width = 8, height = 6, units = "in", res = 400)
par(mfrow=c(2,1))
plot(behav.list2$`19`$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt,col='red'); title(main="ID 19 (n=3)")
plot(behav.list2$`19`$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt,col='red')
dev.off()
png("ID 19 behav seg image Vp_Vt.png", width = 8, height = 6, units = "in", res = 400)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue'); title(main="ID 19 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue')
dev.off()
write.csv(dat19.res2$breakpt, "ID19 Breakpoints (Behavior) Vp_Vt.csv", row.names = F)
dat12.res2<- behav.gibbs.sampler_veloc(behav.list2$`12`,50000)
length(dat12.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`12`$Vp, xlab = "", ylab = "Vp"); abline(v=dat12.res2$breakpt,col='red'); title(main="ID 12 (n=3)")
plot(behav.list2$`12`$Vt, xlab = "", ylab = "Vt"); abline(v=dat12.res2$breakpt,col='red')
behav.heat<- behav.seg.image_veloc(behav.list2$`12`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat12.res2$breakpt/nrow(behav.list2$`12`),
col='blue'); title(main="ID 12 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat12.res2$breakpt/nrow(behav.list2$`12`),
col='blue')
length(dat19.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`19`$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt,col='red'); title(main="ID 19 (n=3)")
plot(behav.list2$`19`$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt,col='red')
length(dat27.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`27`$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt,col='red'); title(main="ID 27 (n=3)")
plot(behav.list2$`27`$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt,col='red')
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
behav.heat<- behav.seg.image_veloc(behav.list2$`27`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue'); title(main="ID 27 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat27.res2$breakpt/nrow(behav.list2$`27`),
col='blue')
behav.heat<- behav.seg.image_veloc(behav.list2$`19`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue'); title(main="ID 19 (n=2)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat19.res2$breakpt/nrow(behav.list2$`19`),
col='blue')
par(mfrow=c(1,1))
plot(dat19.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 19")
plot(dat19.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 19")
par(mfrow=c(1,1))
plot(dat27.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 27")
plot(dat27.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 27")
plot(dat12.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 12")
plot(dat12.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 12")
behav.heat<- behav.seg.image_veloc(behav.list2$`12`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat12.res2$breakpt/nrow(behav.list2$`12`),
col='blue'); title(main="ID 12 (n=2)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat12.res2$breakpt/nrow(behav.list2$`12`),
col='blue')
dat1.res2<- behav.gibbs.sampler_veloc(behav.list2$`1`,50000)
length(dat1.res2$breakpt)
par(mfrow=c(2,1))
plot(behav.list2$`1`$Vp, xlab = "", ylab = "Vp"); abline(v=dat1.res2$breakpt,col='red'); title(main="ID 1 (n=3)")
plot(behav.list2$`1`$Vt, xlab = "", ylab = "Vt"); abline(v=dat1.res2$breakpt,col='red')
behav.heat<- behav.seg.image_veloc(behav.list2$`1`)
dat=behav.list2$`1`
View(dat)
Vp<- matrix(0, nrow(dat), length(unique(dat$Vp)))
unique(dat$Vp)
length(unique(dat$Vt))
summary(dat$Vp)
summary(dat$Vt)
i=1
Vp[i,dat$Vp[i]]
for (i in 1:nrow(dat)){
Vp[i,dat$Vp[i]]=1
}
Vp<- matrix(0, nrow(dat), 8)
for (i in 1:nrow(dat)){
Vp[i,dat$Vp[i]]=1
}
Vt<- matrix(0, nrow(dat), 8)
for (i in 1:nrow(dat)){
Vt[i,dat$Vt[i]]=1
}
source('helper functions.R')
behav.heat<- behav.seg.image_veloc(behav.list2$`1`)
par(mfrow=c(2,1))
image(behav.heat$Vp, xlab = "", ylab = "Vp"); abline(v=dat1.res2$breakpt/nrow(behav.list2$`1`),
col='blue'); title(main="ID 1 (n=3)")
image(behav.heat$Vt, xlab = "", ylab = "Vt"); abline(v=dat1.res2$breakpt/nrow(behav.list2$`1`),
col='blue')
par(mfrow=c(2,1))
plot(behav.list2$`1`$Vp, xlab = "", ylab = "Vp"); abline(v=dat1.res2$breakpt,col='red'); title(main="ID 1 (n=3)")
plot(behav.list2$`1`$Vt, xlab = "", ylab = "Vt"); abline(v=dat1.res2$breakpt,col='red')
hist(dat$Vp)
hist(dat$Vt)
par(mfrow=c(2,1))
plot(behav.list2$`1`$Vp, xlab = "", ylab = "Vp"); abline(v=dat1.res2$breakpt,col='red'); title(main="ID 1 (n=3)")
plot(behav.list2$`1`$Vt, xlab = "", ylab = "Vt"); abline(v=dat1.res2$breakpt,col='red')
par(mfrow=c(1,1))
plot(dat1.res2$store.param[,1], type = "l", xlab = "Iterations", ylab = "# of Breakpoints",
main = "ID 1")
plot(dat1.res2$store.param[,2], type = "l", xlab = "Iterations", ylab = "Log Marginal Likelihood",
main = "ID 1")
par(mfrow=c(2,1))
include_graphics("ID 1 behav seg plot.png")
include_graphics("ID 1 behav seg image.png")
View(dat1)
dat<- read.csv("Snail Kite Gridded Data.csv", header = T, sep = ",")
names(dat)[7]<- "dist"  #change to generic form
behav.list<- behav.prep(dat=dat, tstep = 3600)  #add move params and filter by 3600 s interval
source('helper functions.R')
dat<- read.csv("Snail Kite Gridded Data.csv", header = T, sep = ",")
names(dat)[7]<- "dist"  #change to generic form
behav.list<- behav.prep(dat=dat, tstep = 3600)  #add move params and filter by 3600 s interval
#Load FL map data
usa <- ne_states(country = "United States of America", returnclass = "sf")
fl<- usa %>% filter(name == "Florida")
fl<- st_transform(fl, crs = "+init=epsg:32617") #change projection to UTM 17N
obs1.breakpts_orig<- read.csv("ID1 Breakpoints (Behavior).csv", header = T, sep = ",")
obs1.breakpts_orig=obs1.breakpts_orig[,1]
obs12.breakpts_orig<- read.csv("ID12 Breakpoints (Behavior).csv", header = T, sep = ",")
obs12.breakpts_orig=obs12.breakpts_orig[,1]
obs19.breakpts_orig<- read.csv("ID19 Breakpoints (Behavior).csv", header = T, sep = ",")
obs19.breakpts_orig=obs19.breakpts_orig[,1]
obs27.breakpts_orig<- read.csv("ID27 Breakpoints (Behavior).csv", header = T, sep = ",")
obs27.breakpts_orig=obs27.breakpts_orig[,1]
assign.behav.seg=function(breakpt,dat){
breakpt1=c(0,breakpt,Inf)
n=length(breakpt1)
dat$behav.seg<- NA
for (i in 2:n){
ind=which(breakpt1[i-1]<dat$time1 & dat$time1<breakpt1[i])
dat[ind,"behav.seg"]=i-1
}
dat
}
dat1<- assign.behav.seg(obs1.breakpts_orig, behav.list$`1`)
dat12<- assign.behav.seg(obs12.breakpts_orig, behav.list$`12`)
dat19<- assign.behav.seg(obs19.breakpts_orig, behav.list$`19`)
dat27<- assign.behav.seg(obs27.breakpts_orig, behav.list$`27`)
View(dat1)
ggplot(data = dat1) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg)
ggplot(data = dat1) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y)
ggplot(data = dat1) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y')
library(cowplot)
SL.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
SL.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg[1:13], scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg[1:13], scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg[1:13], scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
SL.hist<- ggplot(data = dat1[dat1$behav.seg <= 13,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg <= 13,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg <= 13,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
SL.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-9
SL.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 9-17
SL.hist<- ggplot(data = dat1[dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 18-26
SL.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
SL.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-9
SL.hist<- ggplot(data = dat12[dat12$behav.seg <= 9,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat12[dat12$behav.seg <= 9,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat12[dat12$behav.seg <= 9,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 9-17
SL.hist<- ggplot(data = dat12[dat12$behav.seg > 9 & dat12$behav.seg <= 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat12[dat12$behav.seg > 9 & dat12$behav.seg <= 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat12[dat12$behav.seg > 9 & dat12$behav.seg <= 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 18-25
SL.hist<- ggplot(data = dat12[dat12$behav.seg > 17 & dat12$behav.seg <= 25,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat12[dat12$behav.seg > 17 & dat12$behav.seg <= 25,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat12[dat12$behav.seg > 17 & dat12$behav.seg <= 25,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 26-31
SL.hist<- ggplot(data = dat12[dat12$behav.seg > 25,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat12[dat12$behav.seg > 25,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat12[dat12$behav.seg > 25,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-5
SL.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-2
SL.hist<- ggplot(data = dat27) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat27) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat27) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-5
SL.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat19) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 1-9
SL.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg <= 9,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 9-17
SL.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg > 9 & dat1$behav.seg <= 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
#Segments 18-26
SL.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=SL)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TA.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=TA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
TAA.hist<- ggplot(data = dat1[dat1$behav.seg > 17,]) +
geom_histogram(aes(x=TAA)) +
facet_wrap(~behav.seg, scales = 'free_y', ncol = 1) +
theme_bw()
plot_grid(SL.hist,TA.hist,TAA.hist, ncol = 3, labels = "")
