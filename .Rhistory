color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat), color = "black") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat)) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat)) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat, color = 1:nrow(dat[dat$id==1,]))) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat, color = 1:nrow(dat[dat$id==1,]))) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat), size=0.5) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat), size=0.35) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat), size=0.35) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot(data = fl) +
geom_sf() +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat), size=0.35) +
scale_color_viridis_c("Time") +
geom_point(data = dat[dat$id==1,], aes(x = utmlong, y = utmlat,
color = 1:nrow(dat[dat$id==1,]))) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[1], y = utmlat[1]), size = 3, fill = "green",
shape = 24) +
geom_point(data = dat[dat$id==1,],aes(x = utmlong[nrow(dat[dat$id==1,])],
y = utmlat[nrow(dat[dat$id==1,])]), size = 3, fill = "red",
shape = 22) +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggsave("Raw Map ID 1.png", width = 5, height = 7, units = "in", dpi = 400)
setwd("~/Documents/Snail Kite Project/Cat-Dirichlet Gibbs Sampler")
source("~/Documents/Snail Kite Project/Cat-Dirichlet Gibbs Sampler/gibbs functions2.R")
setwd("~/Documents/Snail Kite Project/Data")
obs<- read.csv("Occupancy Matrix for all Obs and Locs.csv", header = T, sep = ",")
obs1.breakpts<- read.csv("ID1 Breakpoints (5 km).csv", header = T, sep = ",")
obs1.breakpts=obs1.breakpts[,1]
obs1=data.frame(obs) %>% filter(id == 1) %>% dplyr::select(-id)
obs1$time1=1:nrow(obs1)
nloc=ncol(obs)-1 #remove time1
obs1.seg=get.summary.stats(obs1.breakpts,obs1,nloc)
assign.time.seg<- function(obs, breakpts, dat) {
seg.n=apply(obs,1,sum)
time.seg=rep(1:(length(breakpts)+1), seg.n)
dat$time.seg<- time.seg
dat
}
dat1=dat %>% filter(id==1)
dat1<- assign.time.seg(obs1.seg, obs1.breakpts, dat1)
View(dat1)
grid_5<- raster(extent(min(dat$utmlong), max(dat$utmlong),
min(dat$utmlat), max(dat$utmlat)) + 10000)
res(grid_5)<- 5000
proj4string(grid_5)<- CRS("+init=epsg:32617")
grid_5[]<- 0
grid.cell.locs<- coordinates(grid_5) %>% data.frame()
borders_5<- rasterToPolygons(grid_5, dissolve = F)
borders_5f<- fortify(borders_5)
grid_5f<- as.data.frame(grid_5, xy = TRUE)
names(grid.cell.locs)<- c("grid.x", "grid.y")
grid.cell.locs$grid.cell<- 1:length(grid_5)
dat1<- left_join(dat1,grid.cell.locs, by="grid.cell")
mode.fun<- function(x) {
names(table(x))[table(x)==max(table(x))]
}
attr.cntrs1<- matrix(NA, length(unique(dat1$time.seg)), 4)
id.attr.cntr=function(dat,attr.cntrs) {
for (i in 1:length(unique(dat$time.seg))) {
tmp=mode.fun(dat[dat$time.seg == i, "grid.cell"])
tmp=ifelse(length(tmp) > 1, tmp[1], tmp) #arbitrary selection of 1st cell in set if multiple vals
attr.cntrs[i,1]=as.numeric(tmp)
attr.cntrs[i,2]=grid.cell.locs[grid.cell.locs$grid.cell==attr.cntrs[i,1], "grid.x"]
attr.cntrs[i,3]=grid.cell.locs[grid.cell.locs$grid.cell==attr.cntrs[i,1], "grid.y"]
attr.cntrs[i,4]=max(table(dat[dat$time.seg == i, "grid.cell"]))
}
colnames(attr.cntrs)<- c("grid.cell","grid.x","grid.y","size")
attr.cntrs<- data.frame(attr.cntrs)
attr.cntrs$time.seg<- 1:length(unique(dat$time.seg))
attr.cntrs
}
attr.cntrs1=id.attr.cntr(dat1, attr.cntrs1)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Time Segment") +
labs(x = "Easting", y = "Northing") +
theme_bw()
dat.size1=matrix(NA,nrow(dat1),1)
n.per.tseg=function(dat,dat.size) {
for (i in 1:length(unique(dat$time.seg))) {
tmp=table(dat[dat$time.seg == i, "grid.cell"]) %>% data.frame()
ind=which(dat$time.seg == i)
for (j in ind){
dat.size[j,]=tmp[which(tmp$Var1 == dat$grid.cell[j]),2]
}
}
dat.size
}
dat1$size<- n.per.tseg(dat1, dat.size1) %>% as.vector()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Time Segment (n=49)") +
labs(x = "Easting", y = "Northing", title = "ID 1") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Time Segment (n=49)") +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Time Segment (n=49)") +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggsave("Space Segmentation Map.png", width = 5, height = 7, units = "in", dpi = 400)
setwd("~/Documents/Snail Kite Project/UFII Symposium")
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggsave("Space Segmentation Map.png", width = 5, height = 7, units = "in", dpi = 400)
setwd("~/Documents/Snail Kite Project/git_segmentation_behavior")
obs1.breakpts_orig<- read.csv("ID1 Breakpoints (Behavior).csv", header = T, sep = ",")
obs1.breakpts_orig=obs1.breakpts_orig[,1]
assign.behav.seg=function(breakpt,dat){
breakpt1=c(0,breakpt,Inf)
n=length(breakpt1)
dat$behav.seg<- NA
for (i in 2:n){
ind=which(breakpt1[i-1]<dat$time1 & dat$time1<breakpt1[i])
dat[ind,"behav.seg"]=i-1
}
dat
}
behav.list<- behav.prep(dat=dat, tstep = 3600)  #add move params and filter by 3600 s interval
source("helper functions2.R")
source("helper functions.R")
behav.list<- behav.prep(dat=dat, tstep = 3600)  #add move params and filter by 3600 s interval
dat1<- assign.behav.seg(obs1.breakpts_orig, behav.list$`1`)
dat1.full<-  dat %>% filter(id==1)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1.full, aes(x=utmlong, y=utmlat), color="gray60", size=0.25) +
geom_point(data = dat1.full, aes(x=utmlong, y=utmlat), color='gray75', size=1) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "ID 1 (n=26)") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1.full, aes(x=utmlong, y=utmlat), color="gray60", size=0.25) +
geom_point(data = dat1.full, aes(x=utmlong, y=utmlat), color='gray75', size=1) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1.full, aes(x=utmlong, y=utmlat), color="gray60", size=0.25) +
geom_point(data = dat1.full, aes(x=utmlong, y=utmlat), color='gray75', size=1) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Behavioral Segment") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1.full, aes(x=utmlong, y=utmlat), color="gray60", size=0.25) +
geom_point(data = dat1.full, aes(x=utmlong, y=utmlat), color='gray75', size=1) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1.full, aes(x=utmlong, y=utmlat), color="gray60", size=0.25) +
geom_point(data = dat1.full, aes(x=utmlong, y=utmlat), color='gray75', size=1) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw()
ggsave("Behavior Segmentation Map full.png", width = 5, height = 7, units = "in", dpi = 400)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 3)
ggsave("Behavior Segmentation Map facet.png", width = 7, height = 5, units = "in", dpi = 400)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Space") +
theme_bw()
dat1=dat %>% filter(id==1)
dat1<- assign.time.seg(obs1.seg, obs1.breakpts, dat1)
dat1<- left_join(dat1,grid.cell.locs, by="grid.cell")
dat1$size<- n.per.tseg(dat1, dat.size1) %>% as.vector()
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_path(data = dat1, aes(x=grid.x, y=grid.y), color="gray60", size=0.25) +
geom_point(data = dat1, aes(x=grid.x, y=grid.y, color = as.numeric(time.seg)), pch=21,stroke=1.25,
size=dat1$size/nrow(dat1)*100, alpha=0.7) +
geom_path(data = attr.cntrs1, aes(x=grid.x, y=grid.y)) +
geom_point(data = attr.cntrs1, aes(x=grid.x, y=grid.y, color = time.seg), pch=21, stroke=1.25,
size=attr.cntrs1$size/nrow(dat1)*100) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Space") +
theme_bw()
ggsave("Space Segmentation Map.png", width = 5, height = 7, units = "in", dpi = 400)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 7)
dat1<- assign.behav.seg(obs1.breakpts_orig, behav.list$`1`)
dat1.full<-  dat %>% filter(id==1)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 7)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 7)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 6)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 5)
ggplot() +
geom_sf(data = fl) +
coord_sf(xlim = c(min(dat$utmlong-20000), max(dat$utmlong+20000)),
ylim = c(min(dat$utmlat-20000), max(dat$utmlat+20000)), expand = FALSE) +
geom_point(data = dat1, aes(utmlong, utmlat, color=behav.seg), size=1) +
scale_color_viridis_c("Segment #") +
labs(x = "Easting", y = "Northing", title = "Behavior") +
theme_bw() +
facet_wrap(~behav.seg, nrow = 5)
ggsave("Behavior Segmentation Map facet.png", width = 5, height = 7, units = "in", dpi = 400)
